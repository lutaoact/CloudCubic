<div class="student-lecture-answers">
  <div class="text-center"
       id="lecture-question">
    <div class="lecture-nav-tabs">
      <a ng-click="setQuestionType('quizzes')"
         ng-if="lecture.quizzes.$submitted"
         ng-class="{'selected':lecture.quizzes.$active}"
         class="btn btn-default"
         du-smooth-scroll
         offset="60"
         href="#lecture-question">
        <i class="fa fa-clock-o"></i>
        随堂练习
      </a>
      <a ng-click="setQuestionType('homeworks')"
         ng-if="lecture.homeworks.length>0"
         ng-class="{'selected':lecture.homeworks.$active}"
         class="btn btn-default"
         du-smooth-scroll
         offset="60"
         href="#lecture-question">
        <i class="fa fa-file-o"></i>
        课后作业
      </a>
      <a ng-click="showOfflineWorks()"
         ng-class="{'selected':offlineWorksShown}"
         class="btn btn-default"
         du-smooth-scroll
         offset="60"
         href="#lecture-question">
        <i class="fa fa-file-o"></i>
        作业上传
      </a>
    </div>
  </div>
  <div class="questions-panel container" ng-show="displayQuestions">
    <div class="list-group">

      <div class="list-group-item question-item"
           ng-repeat="question in displayQuestions|filter:{'$notAnswered':false}|paging:viewState.pageSize:viewState.currentPage[questionsType]">
        <div class="mark-group" ng-if="displayQuestions.$submitted">
          <i class="indicator correct fa fa-check" ng-if="question.$correct"></i>
          <i class="indicator incorrect fa fa-times" ng-if="!question.$correct"></i>
        </div>
        <div class="content-group">
          <h5 class="text-default">
            {{$index + 1 + (viewState.currentPage[questionsType] - 1) * viewState.pageSize}}.
            {{question.body | questionTitle}}
          </h5>
          <div class="question-image"
               ng-repeat="imageKey in question.body | questionImage">
            <img ng-src="{{imageKey}}">
          </div>
          <div class="checkbox"
               ng-class="{'text-muted':displayQuestions.$submitted||displayQuestions!=lecture.homeworks}"
               ng-repeat="option in question.choices">
            <label>
              {{$index|indexToABC}}.
              <input type="checkbox" class="bud checkbox-primary"
                     ng-disabled="displayQuestions.$submitted||displayQuestions!=lecture.homeworks"
                     ng-model="option.$selected">
              {{option.text}}
            </label>
          </div>
          <question-answer question="question"
                           keypoints="keyPoints"
                           ng-if="displayQuestions.$submitted">
          </question-answer>
        </div>
      </div>

    </div>
    <button type="button"
            ng-show="displayQuestions==lecture.homeworks"
            ng-disabled="displayQuestions.$submitted"
            class="pull-right submit-btn btn btn-danger"
            ng-click="submitAnswer()">
      <span ng-if="displayQuestions.$submitted">课后作业已经提交</span>
      <span ng-if="!displayQuestions.$submitted">提交课后作业</span>
    </button>
    <pager
      total-items="displayQuestions.length"
      items-per-page="viewState.pageSize"
      align="false"
      class="bud"
      ng-model="viewState.currentPage[questionsType]"
      ng-show="displayQuestions.length > viewState.pageSize">
    </pager>
  </div>

  <div class="question-panel container" ng-show="offlineWorksShown">
    <form class="offline-homework clearfix" role="form" ng-submit="submitOfflineWork(offlineWork)">
      <div class="form-group">
        <text-angular id="inputDesc" class="bud" ng-model="offlineWork.desc"></text-angular>
      </div>
      <div class="form-group clearfix">
        <div class="file col-md-6" ng-repeat="file in offlineWork.files">
          <div ng-if="!file.url">
            <progressbar class="active upload-progressbar" value="file.$progress" type="info">
              类型:{{file.name.split('.').pop()}}{{file.name}}:{{file.size}}
            </progressbar>
          </div>
          <div ng-if="file.url">
            类型:{{file.name.split('.').pop()}}{{file.name}}:{{file.size}}
            <a href="{{file.url}}" target="blank" class="btn btn-default"><i class="fa fa-cloud-download"></i></a>
            <a class="btn btn-danger pull-right" ng-if="!offlineWork.submitted" ng-click="removeFile(file)"><i class="fa fa-times"></i></a>
          </div>
        </div>
      </div>
      <div class="form-group pull-right">
        <uploader limit="500*1024*1024"
                  multiple="true"
                  on-complete="onFilesUploaded($data,$meta)"
                  on-begin="onFilesUploadStart($files)"
                  on-progress="onFilesUploading($speed, $percentage, $event)"
                  on-error="onError($error)"
                  ng-if="!offlineWork.submitted"
                  class="btn btn-danger">
          <i class="fa fa-paperclip"></i>
          添加附件
        </uploader>
        <button type="submit" class="btn btn-primary" ng-disabled="offlineWork.submitted">{{offlineWork.submitted?'已提交':'交作业'}}</button>
      </div>
    </form>
  </div>
</div>

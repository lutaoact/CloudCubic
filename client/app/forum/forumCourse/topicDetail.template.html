<div class="bud topic-detail">
  <div ng-show="topic">
    <div class="bud article">

      <div class="article-header">
        <div class="article-header-left">
          <h3 class="article-title">{{topic.title}}
          </h3>
          <div class="post-time">{{topic.modified|date:'yyyy/MM/dd'}}</div>
          <div class="comment-count"><i class="fa fa-comments"></i>{{topic.$replies.length||0}}</div>
        </div>
        <div class="article-header-right">
          <div class="media-object avatar-md"
               source-attr="background-image"
               suffix="?imageView2/1/w/64/h/64"
               src-key="topic.postBy.avatar">
          </div>
          <h6 class="poster-name">{{topic.postBy.name}}</h6>
        </div>
      </div>

      <div class="article-body">
        <div class="blog" compile-html="topic.content" >
        </div>
      </div>
    </div>

    <hr>
    <div class="replies">
      <h5 class="base-color">{{topic.$replies.length||0}}个答复<small><i class="fa fa-comments"></i></small></h5>

      <div class="new-reply">
        <div class="new-reply-left">
          <div class="media-object avatar-sm"
               source-attr="background-image"
               src="http://placehold.it/32x32"
               src-key="me.avatar"
               suffix="?imageView2/1/w/64/h/64">
          </div>
        </div>
        <div class="new-reply-right" is-visible="viewState.newReplyVisible">
          <bud-editor 
            content="newReply.content"
            metadata="newReply.metadata">
          </bud-editor>
        </div>
        

        <div>
          <button class="btn btn-danger btn-sm rounded submit pull-right" ng-click="replyTo(topic, newReply)">提交</button>
        </div>
      </div>


      <ul class="list-group ">
        <li class="bud thumbnail media col-md-12 reply"
            ng-repeat="reply in topic.$replies">
          <a class="pull-left" href>
            <div class="media-object avatar-sm"
                 source-attr="background-image"
                 src="http://placehold.it/32x32"
                 src-key="reply.postBy.avatar"
                 suffix="?imageView2/1/w/64/h/64">
            </div>
          </a>
          <div class="media-body">

            <h5 class="base-color reply-author-name">{{reply.postBy.name}}
              <small>|</small>
              <small>{{reply.created|timeToTimeAgo}}</small>
              <a href ng-show="reply.postBy._id == me._id" class="pull-right" ng-click="deleteReply(topic, reply)">删除</a>
            </h5>

            <div class="reply-body blog" compile-html="reply.content" ></div>
            <span class="pull-right">
              <a href="" class="btn vote">
                <i
                  class="fa"
                  ng-class="{'fa-heart-o':reply.voteUpUsers.indexOf(me._id)<0,'fa-heart':reply.voteUpUsers.indexOf(me._id)>=0}"
                  ng-click="toggleVote(reply)">
                </i>
              </a>
              {{reply.voteUpUsers.length||0}}个赞
            </span>
          </div>
        </li>
      </ul>

      <a class="btn form-control btn-primary btn-lg rounded"
        style="margin: 20px 0;border-radius: 3px; height: 49px;"
        ng-click="scrollToEditor()">
        快速回复该帖
      </a>
    </div>

  </div>
</div>

<div class="bud topic-detail">
  <div ng-show="topic">
    <div class="bud article">

      <div class="article-header">
        <h4 class="article-title">
          {{topic.title}}
        </h4>
        <span class="spans">
          <span class="flag flag-danger">
          {{topic.metadata.postType||'提问'}}
          </span>
          <div class="pull-left avatar-xs "
               source-attr="background-image"
               src="http://placehold.it/32x32"
               src-key="topic.postBy.avatar"
               suffix="?imageView2/1/w/64/h/64">
          </div>
          <span class="poster-name">{{topic.postBy.name}}</span>
          <span class="text-muted created-time">发表于{{topic.created|timeToTimeAgo}}</span>
          <span class="status">
            <i class="fa fa-comments base-color"></i>
            {{topic.$replies.length||0}}
          </span>
          <span class="status">
            <i class="fa fa-eye"></i>
            {{topic.viewedUsers.length||0}}
          </span>
          <span class="status">
            <i class="fa fa-heart" 
              ng-class="{'active':topic.voteUpUsers.indexOf(me._id)>=0}"
              ng-click="toggleLike(topic)"></i>
            {{topic.voteUpUsers.length||0}}
          </span>
        </span>
      </div>

      <div class="article-body">
        <div class="blog" compile-html="topic.content" >
        </div>
      </div>
    </div>

    <hr>
    <div class="replies">
      <div class="new-reply">
        <div class="new-reply-left">
          <div class="media-object avatar-sm"
               source-attr="background-image"
               src="http://placehold.it/32x32"
               src-key="me.avatar"
               suffix="?imageView2/1/w/64/h/64">
          </div>
        </div>
        <div class="new-reply-right" is-visible="viewState.newReplyVisible">
          <bud-editor 
            content="newReply.content"
            metadata="newReply.metadata">
          </bud-editor>
        </div>

        <div>
          <button class="btn btn-danger btn-sm rounded submit pull-right" ng-click="replyTo(topic, newReply)">提交</button>
        </div>
      </div>

      <ul class="list-group ">
        <li class="bud thumbnail media col-md-12 reply"
            ng-repeat="reply in topic.$replies">
          <a class="pull-left" href>
            <div class="media-object avatar-sm"
                 source-attr="background-image"
                 src="http://placehold.it/32x32"
                 src-key="reply.postBy.avatar"
                 suffix="?imageView2/1/w/64/h/64">
            </div>
          </a>
          <div class="media-body">

            <h5 class="base-color reply-author-name">{{reply.postBy.name}}
              <small>|</small>
              <small>{{reply.created|timeToTimeAgo}}</small>
              <small>|</small>
              <small>
                <i
                  class="fa fa-heart vote"
                  ng-class="{'active':reply.voteUpUsers.indexOf(me._id)>=0}"
                  ng-click="toggleVote(reply)">
                </i>
                {{reply.voteUpUsers.length||0}}
              </small>
              <a href ng-show="reply.postBy._id == me._id" class="pull-right" ng-click="deleteReply(topic, reply)"><i class="fa fa-times"></i></a>
            </h5>
            <div class="reply-body blog" compile-html="reply.content" ></div>
          </div>
        </li>
      </ul>

      <a class="btn form-control btn-primary btn-lg rounded"
        style="margin: 20px 0;border-radius: 3px; height: 49px;"
        ng-click="scrollToEditor()">
        快速回复该帖
      </a>
    </div>

  </div>
</div>
